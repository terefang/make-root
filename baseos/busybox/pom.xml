<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>parent</artifactId>
        <groupId>terefang.makeroot</groupId>
        <version>2021.1.0</version>
        <relativePath>../../pom.xml</relativePath>
    </parent>
    <modelVersion>4.0.0</modelVersion>

    <groupId>terefang.makeroot.baseos</groupId>
    <artifactId>busybox</artifactId>
    <version>1.34.1</version>
    <packaging>pom</packaging>

    <properties>
        <busybox.url>https://busybox.net/downloads/binaries/1.31.0-defconfig-multiarch-musl/busybox-x86_64</busybox.url>
        <busybox.tag>busybox-${project.version}</busybox.tag>
        <busybox.archive>${busybox.tag}.tar.bz2</busybox.archive>
        <archive.url>https://busybox.net/downloads/${busybox.archive}</archive.url>
        <keymap.url>https://dev.alpinelinux.org/bkeymaps/</keymap.url>
    </properties>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-antrun-plugin</artifactId>
                <version>1.8</version>
                <inherited>false</inherited>
                <dependencies>
                    <dependency>
                        <groupId>org.redline-rpm</groupId>
                        <artifactId>redline</artifactId>
                        <version>1.2.9</version>
                        <classifier>jar-with-dependencies</classifier>
                    </dependency>
                    <dependency>
                        <groupId>org.apache.ant</groupId>
                        <artifactId>ant-compress</artifactId>
                        <version>1.5</version>
                    </dependency>
                    <dependency>
                        <groupId>com.github.terefang</groupId>
                        <artifactId>ant-archive-plus</artifactId>
                        <version>1.5.2</version>
                    </dependency>
                </dependencies>
                <executions>
                    <execution>
                        <id>ant</id>
                        <phase>package</phase>
                        <goals>
                            <goal>run</goal>
                        </goals>
                        <configuration>
                            <target xmlns:if="ant:if" xmlns:unless="ant:unless">
                                <taskdef classname="org.redline_rpm.ant.RedlineTask" name="xrpm" />
                                <taskdef classname="org.apache.ant.compress.taskdefs.Cpio" name="cpio" />

                                <taskdef name="xtar" classname="com.github.terefang.ant.archiveplus.taskdefs.Tar" />
                                <typedef name="symlink" classname="com.github.terefang.ant.archiveplus.resources.SymbolicLink" />

                                <mkdir dir="${rpm.path}"/>
                                <mkdir dir="${project.basedir}/src/main/dist/keymaps"/>
                                <mkdir dir="${toolchain.dir}"/>

                                <condition property="binary.exists">
                                    <resourceexists>
                                        <file file="${project.basedir}/src/main/dist/busybox.x86_64.${project.version}"/>
                                    </resourceexists>
                                </condition>

                                <!--condition property="static.binary.exists">
                                    <resourceexists>
                                        <file file="${project.basedir}/src/main/dist/busybox.x86_64.static"/>
                                    </resourceexists>
                                </condition-->

                                <condition property="archive.exists">
                                    <resourceexists>
                                        <file file="${project.basedir}/src/main/dist/${busybox.archive}"/>
                                    </resourceexists>
                                </condition>

                                <condition property="keymap.exists">
                                    <resourceexists>
                                        <file file="${project.basedir}/src/main/dist/keymaps/us.bmap"/>
                                    </resourceexists>
                                </condition>

                                <get unless:true="${keymap.exists}" src="${keymap.url}/de/de-latin1-nodeadkeys.bmap" dest="${project.basedir}/src/main/dist/keymaps/"/>
                                <get unless:true="${keymap.exists}" src="${keymap.url}/de/de-latin1.bmap" dest="${project.basedir}/src/main/dist/keymaps/"/>
                                <get unless:true="${keymap.exists}" src="${keymap.url}/de/de.bmap" dest="${project.basedir}/src/main/dist/keymaps/"/>
                                <get unless:true="${keymap.exists}" src="${keymap.url}/us/us.bmap" dest="${project.basedir}/src/main/dist/keymaps/"/>

                                <!--get unless:true="${static.binary.exists}" src="${busybox.url}" dest="${project.basedir}/src/main/dist/busybox.x86_64.static"/-->

                                <get unless:true="${archive.exists}" src="${archive.url}" dest="${project.basedir}/src/main/dist/${busybox.archive}"/>

                                <exec unless:true="${binary.exists}" dir="${toolchain.dir}" executable="tar">
                                    <arg line="-xvf ${resources.target}/gcc-10-x86_64-linux-musl-native.tar.gz" />
                                </exec>
                                <exec unless:true="${binary.exists}" dir="${toolchain.dir}" executable="tar">
                                    <arg line="-xvf ${resources.target}/muslsys-libxcrypt-${version.libxcrypt}.tgz" />
                                </exec>
                                <exec unless:true="${binary.exists}" dir="${project.build.directory}/${project.artifactId}" executable="tar">
                                    <arg line="-xvf ${project.basedir}/src/main/dist/${busybox.archive}" />
                                </exec>

                                <exec unless:true="${binary.exists}" dir="${project.build.directory}/${project.artifactId}/${busybox.tag}" executable="make">
                                    <env key="PATH" value="${env.PATH}:${project.build.directory}/${project.artifactId}/toolchain/bin" />
                                    <arg line="defconfig" />
                                </exec>

                                <copy unless:true="${binary.exists}" file="src/main/dist/config.x86_64-linux-musl.${project.version}" tofile="${project.build.directory}/${project.artifactId}/${busybox.tag}/.config" overwrite="true" />

                                <exec unless:true="${binary.exists}" dir="${project.build.directory}/${project.artifactId}/${busybox.tag}" executable="make">
                                    <env key="PATH" value="${env.PATH}:${toolchain.dir}/bin" />
                                    <arg line="oldconfig" />
                                </exec>

                                <exec unless:true="${binary.exists}" dir="${project.build.directory}/${project.artifactId}/${busybox.tag}" executable="make">
                                    <env key="PATH" value="${env.PATH}:${toolchain.dir}/bin" />
                                    <arg line="-j 8 V=1" />
                                </exec>

                                <mkdir unless:true="${binary.exists}" dir="${project.basedir}/src/main/dist"/>
                                <copy unless:true="${binary.exists}" tofile="${project.basedir}/src/main/dist/busybox.x86_64.${project.version}">
                                    <fileset file="${project.build.directory}/busybox/${busybox.tag}/${project.artifactId}" />
                                </copy>

                                <copy tofile="${project.build.directory}/${project.artifactId}/busybox">
                                    <fileset file="${project.basedir}/src/main/dist/busybox.x86_64.${project.version}" />
                                </copy>
                                <copy tofile="${project.build.directory}/${project.artifactId}/busybox.suid">
                                    <fileset file="${project.basedir}/src/main/dist/busybox.x86_64.${project.version}" />
                                </copy>

                                <cpio destfile="${rpm.path}/bootos-busybox.cpio" >
                                    <tarfileset fullpath="/bin/busybox" file="${project.build.directory}/${project.artifactId}/busybox" filemode="555"/>
                                </cpio>

                                <xtar destfile="${rpm.path}/test-bootos-busybox.tar.gz" compression="gzip">
                                    <tarfileset fullpath="/bin/busybox" file="${project.build.directory}/${project.artifactId}/busybox" filemode="555"/>
                                    <symlink name="/bin/ping" target="./busybox" user="root" group="root" permissions="555"/>
                                </xtar>

                                <xrpm
                                        architecture="X86_64"
                                        destination="${rpm.path}"
                                        license="GPLv2"
                                        group="baseos"
                                        name="baseos-${project.artifactId}"
                                        summary="BusyBox combines tiny versions of many common UNIX utilities into a single small executable."
                                        distribution="nos"
                                        packager="nos"
                                        url="https://busybox.net/"
                                        vendor="nos"
                                        epoch="${buildNumber}"
                                        release="${buildNumber}.nos.${project.parent.version}"
                                        version="${project.version}">

                                    <emptydir path="/etc/cron.weekly" filemode='600' dirmode='755' username="root" group="root"/>
                                    <emptydir path="/etc/cron.monthly" filemode='600' dirmode='755' username="root" group="root"/>
                                    <emptydir path="/etc/cron.hourly" filemode='600' dirmode='755' username="root" group="root"/>
                                    <emptydir path="/etc/cron.daily" filemode='600' dirmode='755' username="root" group="root"/>
                                    <rpmfileset prefix="/etc/cron.d" filemode='600' file="${project.basedir}/src/main/dist/cron/root" username="root" group="root" addParents="false" />

                                    <rpmfileset prefix="/usr/lib/bmap" filemode='444' dir="${project.basedir}/src/main/dist/keymaps/" username="root" group="root" addParents="false" />

                                    <link path="/usr/bin/[[" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/awk" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/bc" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/beep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/blkdiscard" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/bunzip2" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/bzcat" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/bzip2" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/chpst" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/chvt" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/clear" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cmp" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/crontab" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cryptpw" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/dc" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/deallocvt" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/diff" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/dos2unix" target="/usr/bin/busybox" />
                                    <!--link path="/usr/bin/dpkg" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/bin/dpkg-deb" target="/usr/bin/busybox" /-->
                                    <link path="/usr/bin/dumpleases" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/envdir" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/envuidgid" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fgconsole" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/find" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/free" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ftpget" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ftpput" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fuser" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/hd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/hexedit" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/killall" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/less" target="/usr/bin/busybox" />
                                    <!--link path="/usr/bin/lpq" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/bin/lpr" target="/usr/bin/busybox" /-->
                                    <link path="/usr/bin/lsof" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lspci" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lsscsi" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lsusb" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lzcat" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lzma" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/man" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/microcom" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mkpasswd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nc" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nmeter" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nslookup" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/openvt" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/patch" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pgrep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pkill" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pmap" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pscan" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pstree" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pwdx" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/reset" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/resize" target="/usr/bin/busybox" />
                                    <!--link path="/usr/bin/rpm2cpio" target="/usr/bin/busybox" /-->
                                    <link path="/usr/bin/runsv" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/runsvdir" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/rx" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setfattr" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setkeycodes" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setuidgid" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sha3sum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/showkey" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/smemcap" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/softlimit" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ssl_client" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/strings" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sv" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/svc" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/svok" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/tcpsvd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/telnet" target="/usr/bin/busybox" />
                                    <!--link path="/usr/bin/tftp" target="/usr/bin/busybox" /-->
                                    <link path="/usr/bin/time" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/top" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ts" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ttysize" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/udhcpc6" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/udpsvd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/unix2dos" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/unlzma" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/unxz" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/unzip" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/uptime" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/uudecode" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/uuencode" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/vlock" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/volname" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/w" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/wget" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/which" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/whois" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/xargs" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/xxd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/xz" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/xzcat" target="/usr/bin/busybox" />

                                    <link path="/usr/sbin/add-shell" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/addgroup" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/brctl" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/chat" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/crond" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/delgroup" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/deluser" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/dhcprelay" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/dnsd" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ether-wake" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fakeidentd" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fbset" target="/usr/bin/busybox" />
                                    <!--link path="/usr/sbin/ftpd" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/httpd" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/i2cdetect" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/i2cdump" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/i2cget" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/i2cset" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/i2ctransfer" target="/usr/bin/busybox" /-->
                                    <link path="/usr/sbin/ifplugd" target="/usr/bin/busybox" />
                                    <!--link path="/usr/sbin/inetd" target="/usr/bin/busybox" /-->
                                    <link path="/usr/sbin/killall5" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/loadfont" target="/usr/bin/busybox" />
                                    <!--link path="/usr/sbin/lpd" target="/usr/bin/busybox" /-->
                                    <link path="/usr/sbin/nanddump" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/nandwrite" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/nbd-client" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ntpd" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/partprobe" target="/usr/bin/busybox" />
                                    <!--link path="/usr/sbin/popmaildir" target="/usr/bin/busybox" /-->
                                    <link path="/usr/sbin/powertop" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/rdate" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/rdev" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/readahead" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/remove-shell" target="/usr/bin/busybox" />
                                    <!--link path="/usr/sbin/sendmail" target="/usr/bin/busybox" /-->
                                    <link path="/usr/sbin/setfont" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/setlogcons" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/svlogd" target="/usr/bin/busybox" />
                                    <!--link path="/usr/sbin/telnetd" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/tftpd" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubiattach" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubidetach" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubimkvol" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubirename" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubirmvol" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubirsvol" target="/usr/bin/busybox" /-->
                                    <!--link path="/usr/sbin/ubiupdatevol" target="/usr/bin/busybox" /-->
                                    <link path="/usr/sbin/udhcpd" target="/usr/bin/busybox" />

                                    <!-- was without /usr/ -->
                                    <link path="/usr/bin/ash" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/chattr" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/conspy" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cpio" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cttyhack" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/dnsdomainname" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/dumpkmap" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ed" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/egrep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fatattr" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fdflush" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fgrep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fsync" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/grep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/gunzip" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/gzip" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/hostname" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/hush" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/iostat" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ipcalc" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/kbd_mode" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lsattr" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/lzop" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/makemime" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mpstat" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mt" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/netstat" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nuke" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pidof" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/pipe_progress" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ps" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/reformime" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/resume" target="/usr/bin/busybox" />
                                    <!--link path="/usr/bin/rpm" target="/usr/bin/busybox" /-->
                                    <link path="/usr/bin/run-parts" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sed" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setserial" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sh" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/tar" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/usleep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/vi" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/watch" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/zcat" target="/usr/bin/busybox" />

                                    <link path="/usr/sbin/acpid" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/adjtimex" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/arp" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/bootchartd" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/depmod" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/devmem" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fbsplash" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/freeramdisk" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/getty" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/halt" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/hdparm" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ifconfig" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ifdown" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ifenslave" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ifup" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/init" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/insmod" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ip" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ipaddr" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/iplink" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/ipneigh" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/iproute" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/iprule" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/iptunnel" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/klogd" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/loadkmap" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/logread" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/lsmod" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/makedevs" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/mdev" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/mkdosfs" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/mke2fs" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/mkfs.ext2" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/mkfs.vfat" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/modinfo" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/modprobe" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/nameif" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/poweroff" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/raidautorun" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/reboot" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/rmmod" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/route" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/run-init" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/runlevel" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/setconsole" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/slattach" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/start-stop-daemon" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/sysctl" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/syslogd" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/tc" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/tunctl" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/udhcpc" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/uevent" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/vconfig" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/watchdog" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/zcip" target="/usr/bin/busybox" />


                                    <!-- suid exec -->
                                    <link path="/usr/bin/ping" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/ping6" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/passwd" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/traceroute" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/traceroute6" target="/usr/bin/suexec/busybox.suid" />

                                    <link path="/usr/sbin/arping" target="/usr/bin/suexec/busybox.suid" />


                                    <!--

                                    #### DISABLED BY COREUTILS-SINGLE
                                    <link path="/usr/bin/[" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/arch" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/base64" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/yes" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/chroot" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/basename" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cat" target="/usr/bin/busybox" />
                                    /usr/bin/chcon
                                    <link path="/usr/bin/chgrp" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/chmod" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/chown" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cksum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/comm" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/cp" target="/usr/bin/busybox" />
                                    /usr/bin/csplit
                                    <link path="/usr/bin/cut" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/date" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/dd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/df" target="/usr/bin/busybox" />
                                    /usr/bin/dir
                                    /usr/bin/dircolors
                                    <link path="/usr/bin/dirname" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/du" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/echo" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/env" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/expand" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/expr" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/factor" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/false" target="/usr/bin/busybox" />
                                    /usr/bin/fmt
                                    <link path="/usr/bin/fold" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/groups" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/head" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/hostid" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/id" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/install" target="/usr/bin/busybox" />
                                    /usr/bin/join
                                    <link path="/usr/bin/link" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ln" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/logname" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ls" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/md5sum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mkdir" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mkfifo" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mknod" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mktemp" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mv" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nice" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nl" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nohup" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/nproc" target="/usr/bin/busybox" />
                                    /usr/bin/numfmt
                                    <link path="/usr/bin/od" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/paste" target="/usr/bin/busybox" />
                                    /usr/bin/pathchk
                                    /usr/bin/pinky
                                    /usr/bin/pr
                                    <link path="/usr/bin/printenv" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/printf" target="/usr/bin/busybox" />
                                    /usr/bin/ptx
                                    <link path="/usr/bin/pwd" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/readlink" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/realpath" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/rm" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/rmdir" target="/usr/bin/busybox" />
                                    /usr/bin/runcon
                                    <link path="/usr/bin/seq" target="/usr/bin/busybox" />
                                    /usr/bin/sha224sum
                                    /usr/bin/sha384sum
                                    <link path="/usr/bin/sha1sum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sha256sum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sha512sum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/shred" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/shuf" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sleep" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sort" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/split" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/stat" target="/usr/bin/busybox" />
                                    /usr/bin/stdbuf
                                    <link path="/usr/bin/stty" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sum" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/sync" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/tac" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/tail" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/tee" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/test" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/timeout" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/touch" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/tr" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/truncate" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/true" target="/usr/bin/busybox" />
                                    /usr/bin/tsort
                                    <link path="/usr/bin/tty" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/uname" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/unexpand" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/uniq" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/unlink" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/users" target="/usr/bin/busybox" />
                                    /usr/bin/vdir
                                    <link path="/usr/bin/wc" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/who" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/whoami" target="/usr/bin/busybox" />

                                    #### DISABLED BY UTIL-LINUX
                                    <link path="/usr/bin/mount" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/umount" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/cal" target="/usr/bin/busybox" />
                                    /usr/bin/chmem
                                    <link path="/usr/bin/chrt" target="/usr/bin/busybox" />
                                    /usr/bin/col
                                    /usr/bin/colcrt
                                    /usr/bin/colrm
                                    /usr/bin/column
                                    <link path="/usr/bin/dmesg" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/eject" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/fallocate" target="/usr/bin/busybox" />
                                    /usr/bin/fincore
                                    /usr/bin/findmnt
                                    <link path="/usr/bin/flock" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/getopt" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/hexdump" target="/usr/bin/busybox" />
                                    /usr/bin/i386
                                    <link path="/usr/bin/ionice" target="/usr/bin/busybox" />
                                    /usr/bin/ipcmk
                                    <link path="/usr/bin/ipcrm" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/ipcs" target="/usr/bin/busybox" />
                                    /usr/bin/isosize
                                    <link path="/usr/bin/kill" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/last" target="/usr/bin/busybox" />
                                    /usr/bin/lastb
                                    <link path="/usr/bin/linux32" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/linux64" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/login" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/logger" target="/usr/bin/busybox" />
                                    /usr/bin/look
                                    /usr/bin/lsblk
                                    /usr/bin/lscpu
                                    /usr/bin/lsipc
                                    /usr/bin/lslocks
                                    /usr/bin/lslogins
                                    /usr/bin/lsmem
                                    /usr/bin/lsns
                                    /usr/bin/mcookie
                                    <link path="/usr/bin/mesg" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/more" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/mountpoint" target="/usr/bin/busybox" />
                                    /usr/bin/namei
                                    <link path="/usr/bin/nsenter" target="/usr/bin/busybox" />
                                    /usr/bin/prlimit
                                    /usr/bin/raw
                                    /usr/bin/rename
                                    <link path="/usr/bin/renice" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/rev" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/script" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/scriptreplay" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setarch" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setpriv" target="/usr/bin/busybox" />
                                    <link path="/usr/bin/setsid" target="/usr/bin/busybox" />
                                    /usr/bin/setterm
                                    <link path="/usr/bin/su" target="/usr/bin/suexec/busybox.suid" />
                                    <link path="/usr/bin/taskset" target="/usr/bin/busybox" />
                                    /usr/bin/ul
                                    /usr/bin/uname26
                                    <link path="/usr/bin/unshare" target="/usr/bin/busybox" />
                                    /usr/bin/utmpdump
                                    /usr/bin/uuidgen
                                    /usr/bin/uuidparse
                                    <link path="/usr/bin/wall" target="/usr/bin/busybox" />
                                    /usr/bin/wdctl
                                    /usr/bin/whereis
                                    /usr/bin/write
                                    /usr/bin/x86_64
                                    /usr/sbin/addpart
                                    /usr/sbin/agetty
                                    /usr/sbin/blkdiscard
                                    <link path="/usr/sbin/blkid" target="/usr/bin/busybox" />
                                    /usr/sbin/blkzone
                                    <link path="/usr/sbin/blockdev" target="/usr/bin/busybox" />
                                    /usr/sbin/cfdisk
                                    /usr/sbin/chcpu
                                    /usr/sbin/clock
                                    /usr/sbin/ctrlaltdel
                                    /usr/sbin/delpart
                                    <link path="/usr/sbin/fdformat" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fdisk" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/findfs" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fsck" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fsck.minix" target="/usr/bin/busybox" />
                                    /usr/sbin/fsck.cramfs
                                    <link path="/usr/sbin/fsfreeze" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/fstrim" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/hwclock" target="/usr/bin/busybox" />
                                    /usr/sbin/ldattach
                                    <link path="/usr/sbin/losetup" target="/usr/bin/busybox" />
                                    /usr/sbin/mkfs
                                    /usr/sbin/mkfs.cramfs
                                    <link path="/usr/sbin/mkfs.minix" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/mkswap" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/nologin" target="/usr/bin/busybox" />
                                    /usr/sbin/partx
                                    <link path="/usr/sbin/pivot_root" target="/usr/bin/busybox">
                                    <link path="/usr/sbin/readprofile" target="/usr/bin/busybox" />
                                    /usr/sbin/resizepart
                                    /usr/sbin/rfkill
                                    <link path="/usr/sbin/rtcwake" target="/usr/bin/busybox" />
                                    /usr/sbin/runuser
                                    /usr/sbin/sfdisk
                                    <link path="/usr/sbin/sulogin" target="/usr/bin/busybox" />
                                    /usr/sbin/swaplabel
                                    <link path="/usr/sbin/swapoff" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/swapon" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/switch_root" target="/usr/bin/busybox" />
                                    /usr/sbin/wipefs
                                    /usr/sbin/zramctl

                                    #### DISABLED BY SHADOW-UTILS
                                    /usr/bin/chage
                                    /usr/bin/gpasswd
                                    /usr/bin/lastlog
                                    /usr/bin/newgidmap
                                    /usr/bin/newgrp
                                    /usr/bin/newuidmap
                                    /usr/bin/sg
                                    <link path="/usr/sbin/adduser" target="/usr/bin/busybox" />
                                    /usr/sbin/chgpasswd
                                    <link path="/usr/sbin/chpasswd" target="/usr/bin/busybox" />
                                    /usr/sbin/groupadd
                                    /usr/sbin/groupdel
                                    /usr/sbin/groupmems
                                    /usr/sbin/groupmod
                                    /usr/sbin/grpck
                                    /usr/sbin/grpconv
                                    /usr/sbin/grpunconv
                                    /usr/sbin/newusers
                                    /usr/sbin/pwck
                                    /usr/sbin/pwconv
                                    /usr/sbin/pwunconv
                                    /usr/sbin/useradd
                                    /usr/sbin/userdel
                                    /usr/sbin/usermod
                                    /usr/sbin/vigr
                                    /usr/sbin/vipw

                                    -->
                                </xrpm>
                                <xrpm
                                        architecture="X86_64"
                                        destination="${rpm.path}"
                                        license="GPLv2"
                                        group="baseos"
                                        name="baseos-${project.artifactId}-static"
                                        summary="BusyBox combines tiny versions of many common UNIX utilities into a single small executable."
                                        distribution="nos"
                                        packager="nos"
                                        url="https://busybox.net/"
                                        vendor="nos"
                                        epoch="${buildNumber}"
                                        release="${buildNumber}.nos.${project.parent.version}"
                                        version="${project.version}">

                                    <rpmfileset prefix="/usr/bin" filemode='555' file="${project.build.directory}/busybox/busybox" username="root" group="root" addParents="false" />
                                    <rpmfileset prefix="/usr/bin/suexec" filemode='4555' file="${project.build.directory}/busybox/busybox.suid" username="root" group="root" addParents="false" />

                                </xrpm>
                                <xrpm
                                        architecture="X86_64"
                                        destination="${rpm.path}"
                                        license="GPLv2"
                                        group="baseos"
                                        name="baseos-${project.artifactId}-cron"
                                        summary="BusyBox combines tiny versions of many common UNIX utilities into a single small executable."
                                        distribution="nos"
                                        packager="nos"
                                        url="https://busybox.net/"
                                        vendor="nos"
                                        epoch="${buildNumber}"
                                        release="${buildNumber}.nos.${project.parent.version}"
                                        version="${project.version}">

                                    <emptydir path="/etc/cron.weekly" filemode='600' dirmode='755' username="root" group="root"/>
                                    <emptydir path="/etc/cron.monthly" filemode='600' dirmode='755' username="root" group="root"/>
                                    <emptydir path="/etc/cron.hourly" filemode='600' dirmode='755' username="root" group="root"/>
                                    <emptydir path="/etc/cron.daily" filemode='600' dirmode='755' username="root" group="root"/>

                                    <rpmfileset prefix="/etc/cron.d" filemode='600' file="${project.basedir}/src/main/dist/cron/root" username="root" group="root" addParents="false" />

                                    <link path="/usr/bin/crontab" target="/usr/bin/busybox" />
                                    <link path="/usr/sbin/crond" target="/usr/bin/busybox" />
                                </xrpm>
                            </target>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project>